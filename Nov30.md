# Review Notes (Nov 30 re-review)

- `emailit-integration/includes/class-emailit-woocommerce.php:245-320` — WooCommerce fallback path posts directly to EmailIt using `get_option('emailit_api_key')` passed through `sanitize_text_field`. Stored keys are encrypted/base64; this will send a mangled key when the API class is unavailable, leading to silent failures. Pull the decrypted key via `Emailit_API::get_api_key()` or require the API component instead of a manual request.
- `emailit-integration/includes/class-emailit-cli.php:322-366` — `wp emailit webhook test` now hits a webhook route that requires a secret/signature, so it will always 401 after the recent hardening. Add signature generation (reuse the stored secret) or short-circuit with a clear error if no secret is set to keep the command useful.
- `emailit-integration/includes/class-emailit-logger.php:252-263` — Webhook logging still stores full `raw_payload` for every event, which can bloat tables and retain PII. Consider truncating/hash-only storage, gating full payload behind a debug flag, and capping length.
- `emailit-integration/includes/class-emailit-logger.php:48-112` & `emailit-integration/emailit-integration.php:739-757` — Logs table still keeps full HTML/text bodies and webhook payloads. A “minimal logging” mode or length cap would reduce DB growth and speed exports/queries.
